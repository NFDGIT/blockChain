<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>区块链</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <script src="main.js"></script> -->

    <script src="https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <script>
        function mine(){
            $.get("/mine",function (data,status) {
                var obj = JSON.parse(data); 
                code = obj['code'];
                msg = obj['message'];
                if (code == '1') {
                    refreshData();
                }
                alert(msg);
            })
        }
        function refreshData() {
            $.get("/chain",
                    function(data,status){
	 		               // alert("数据: " + data + "\n状态: " + status);
                        //   alert('fdkafjds');
                        //   console.log("kejkfk");
                        // alert(data);
                    refreshUI(data);
	         	    }
            ); 
        }

        function refreshUI(data) {
            var obj = JSON.parse(data);
            

            $("#contentView").html("");
            for (let i = 0; i < obj.length; i++) {
                const element = obj[i];
                const jsonS = JSON.stringify(element);
                $("#contentView").append(jsonS + "</br></br></br>");
            }
        }
        $(document).ready(function(){
            refreshData();

            $("#wakuang").click(function(){
                mine();

                // $.get("/mine",
                //         function(data,status){
	 		    //            // alert("数据: " + data + "\n状态: " + status);
                //         //   alert('fdkafjds');
                //         //   console.log("kejkfk");
                //         // alert(data);
                //         refreshUI(data);
	         	//         }
                // );

            });
        });
    </script>
</head>
<body>
    <p>区块链项目</p>


    <button id="wakuang">挖矿</button>
    <div id="contentView" >f<div></div>

</body>

</html>